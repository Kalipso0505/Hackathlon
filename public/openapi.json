{
    "openapi": "3.1.0",
    "info": {
        "title": "Laravel",
        "version": "0.0.1"
    },
    "servers": [
        {
            "url": "http://localhost/api"
        }
    ],
    "paths": {
        "/debug/personas": {
            "get": {
                "operationId": "debug.personas",
                "summary": "Get all personas with their full knowledge",
                "tags": [
                    "Debug"
                ],
                "responses": {
                    "500": {
                        "description": "",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "enum": [
                                                "Failed to load personas from AI service"
                                            ]
                                        },
                                        "message": {
                                            "type": "string"
                                        },
                                        "personas": {
                                            "type": "array",
                                            "items": {
                                                "type": "string"
                                            },
                                            "minItems": 0,
                                            "maxItems": 0,
                                            "additionalItems": false
                                        }
                                    },
                                    "required": [
                                        "error",
                                        "message",
                                        "personas"
                                    ]
                                }
                            }
                        }
                    },
                    "200": {
                        "description": "",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/game/start": {
            "post": {
                "operationId": "game.start",
                "summary": "Start a new game",
                "tags": [
                    "Game"
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "game_id": {
                                            "type": "string"
                                        },
                                        "scenario_name": {
                                            "type": "string",
                                            "enum": [
                                                "Der Fall InnoTech"
                                            ]
                                        },
                                        "setting": {
                                            "type": "string",
                                            "enum": [
                                                "Die InnoTech GmbH ist ein aufstrebendes Tech-Startup in M\u00fcnchen.",
                                                ""
                                            ]
                                        },
                                        "victim": {
                                            "type": "string",
                                            "enum": [
                                                "Marcus Weber (CFO)"
                                            ]
                                        },
                                        "personas": {
                                            "type": "array",
                                            "prefixItems": [
                                                {
                                                    "type": "object",
                                                    "properties": {
                                                        "slug": {
                                                            "type": "string",
                                                            "enum": [
                                                                "elena"
                                                            ]
                                                        },
                                                        "name": {
                                                            "type": "string",
                                                            "enum": [
                                                                "Elena Schmidt"
                                                            ]
                                                        },
                                                        "role": {
                                                            "type": "string",
                                                            "enum": [
                                                                "CEO"
                                                            ]
                                                        },
                                                        "description": {
                                                            "type": "string",
                                                            "enum": [
                                                                "Die Gr\u00fcnderin und CEO von InnoTech. Professionell, ehrgeizig, kontrolliert."
                                                            ]
                                                        },
                                                        "emoji": {
                                                            "type": "string",
                                                            "enum": [
                                                                "\ud83c\udfe2"
                                                            ]
                                                        },
                                                        "image": {
                                                            "type": "string",
                                                            "enum": [
                                                                "https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?w=200&h=200&fit=crop&crop=faces&q=80"
                                                            ]
                                                        }
                                                    },
                                                    "required": [
                                                        "slug",
                                                        "name",
                                                        "role",
                                                        "description",
                                                        "emoji",
                                                        "image"
                                                    ]
                                                },
                                                {
                                                    "type": "object",
                                                    "properties": {
                                                        "slug": {
                                                            "type": "string",
                                                            "enum": [
                                                                "tom"
                                                            ]
                                                        },
                                                        "name": {
                                                            "type": "string",
                                                            "enum": [
                                                                "Tom Berger"
                                                            ]
                                                        },
                                                        "role": {
                                                            "type": "string",
                                                            "enum": [
                                                                "Lead Developer"
                                                            ]
                                                        },
                                                        "description": {
                                                            "type": "string",
                                                            "enum": [
                                                                "Der technische Kopf des Startups. Introvertiert, brillant, manchmal nerv\u00f6s."
                                                            ]
                                                        },
                                                        "emoji": {
                                                            "type": "string",
                                                            "enum": [
                                                                "\ud83d\udcbb"
                                                            ]
                                                        },
                                                        "image": {
                                                            "type": "string",
                                                            "enum": [
                                                                "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=200&h=200&fit=crop&crop=faces&q=80"
                                                            ]
                                                        }
                                                    },
                                                    "required": [
                                                        "slug",
                                                        "name",
                                                        "role",
                                                        "description",
                                                        "emoji",
                                                        "image"
                                                    ]
                                                },
                                                {
                                                    "type": "object",
                                                    "properties": {
                                                        "slug": {
                                                            "type": "string",
                                                            "enum": [
                                                                "lisa"
                                                            ]
                                                        },
                                                        "name": {
                                                            "type": "string",
                                                            "enum": [
                                                                "Lisa Hoffmann"
                                                            ]
                                                        },
                                                        "role": {
                                                            "type": "string",
                                                            "enum": [
                                                                "Executive Assistant"
                                                            ]
                                                        },
                                                        "description": {
                                                            "type": "string",
                                                            "enum": [
                                                                "Die langj\u00e4hrige Assistentin. Loyal, aufmerksam, diskret."
                                                            ]
                                                        },
                                                        "emoji": {
                                                            "type": "string",
                                                            "enum": [
                                                                "\ud83d\udccb"
                                                            ]
                                                        },
                                                        "image": {
                                                            "type": "string",
                                                            "enum": [
                                                                "https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=200&h=200&fit=crop&crop=faces&q=80"
                                                            ]
                                                        }
                                                    },
                                                    "required": [
                                                        "slug",
                                                        "name",
                                                        "role",
                                                        "description",
                                                        "emoji",
                                                        "image"
                                                    ]
                                                },
                                                {
                                                    "type": "object",
                                                    "properties": {
                                                        "slug": {
                                                            "type": "string",
                                                            "enum": [
                                                                "klaus"
                                                            ]
                                                        },
                                                        "name": {
                                                            "type": "string",
                                                            "enum": [
                                                                "Klaus M\u00fcller"
                                                            ]
                                                        },
                                                        "role": {
                                                            "type": "string",
                                                            "enum": [
                                                                "Facility Manager"
                                                            ]
                                                        },
                                                        "description": {
                                                            "type": "string",
                                                            "enum": [
                                                                "Der erfahrene Hausmeister. Ruhig, beobachtend, kennt alle Ecken."
                                                            ]
                                                        },
                                                        "emoji": {
                                                            "type": "string",
                                                            "enum": [
                                                                "\ud83d\udd27"
                                                            ]
                                                        },
                                                        "image": {
                                                            "type": "string",
                                                            "enum": [
                                                                "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200&h=200&fit=crop&crop=faces&q=80"
                                                            ]
                                                        }
                                                    },
                                                    "required": [
                                                        "slug",
                                                        "name",
                                                        "role",
                                                        "description",
                                                        "emoji",
                                                        "image"
                                                    ]
                                                }
                                            ],
                                            "minItems": 4,
                                            "maxItems": 4,
                                            "additionalItems": false
                                        },
                                        "intro_message": {
                                            "type": "string",
                                            "enum": [
                                                "Willkommen beim Fall \"InnoTech\". Marcus Weber, CFO der InnoTech GmbH, wurde tot aufgefunden. Befrage die Verd\u00e4chtigen und l\u00f6se den Fall!"
                                            ]
                                        }
                                    },
                                    "required": [
                                        "game_id",
                                        "scenario_name",
                                        "setting",
                                        "victim",
                                        "personas",
                                        "intro_message"
                                    ]
                                }
                            }
                        }
                    }
                }
            }
        },
        "/game/chat": {
            "post": {
                "operationId": "game.chat",
                "summary": "Send a chat message",
                "tags": [
                    "Game"
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "game_id": {
                                        "type": "string",
                                        "format": "uuid"
                                    },
                                    "persona_slug": {
                                        "type": "string",
                                        "enum": [
                                            "elena",
                                            "tom",
                                            "lisa",
                                            "klaus"
                                        ]
                                    },
                                    "message": {
                                        "type": "string",
                                        "maxLength": 1000
                                    }
                                },
                                "required": [
                                    "game_id",
                                    "persona_slug",
                                    "message"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "503": {
                        "description": "",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "enum": [
                                                "AI Service nicht erreichbar. Bitte versuche es sp\u00e4ter erneut."
                                            ]
                                        },
                                        "details": {
                                            "type": [
                                                "string",
                                                "null"
                                            ]
                                        }
                                    },
                                    "required": [
                                        "error",
                                        "details"
                                    ]
                                }
                            }
                        }
                    },
                    "200": {
                        "description": "",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "persona_slug": {},
                                        "persona_name": {},
                                        "response": {},
                                        "revealed_clue": {}
                                    },
                                    "required": [
                                        "persona_slug",
                                        "persona_name",
                                        "response",
                                        "revealed_clue"
                                    ]
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "enum": [
                                                "Game is not active"
                                            ]
                                        }
                                    },
                                    "required": [
                                        "error"
                                    ]
                                }
                            }
                        }
                    },
                    "422": {
                        "$ref": "#/components/responses/ValidationException"
                    }
                }
            }
        },
        "/game/{gameId}/history": {
            "get": {
                "operationId": "game.history",
                "summary": "Get chat history for a game",
                "tags": [
                    "Game"
                ],
                "parameters": [
                    {
                        "name": "gameId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "game_id": {
                                            "type": "string"
                                        },
                                        "status": {
                                            "type": "string"
                                        },
                                        "revealed_clues": {
                                            "anyOf": [
                                                {
                                                    "type": "string"
                                                },
                                                {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "string"
                                                    },
                                                    "minItems": 0,
                                                    "maxItems": 0,
                                                    "additionalItems": false
                                                }
                                            ]
                                        },
                                        "messages": {
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "game_id",
                                        "status",
                                        "revealed_clues",
                                        "messages"
                                    ]
                                }
                            }
                        }
                    },
                    "404": {
                        "$ref": "#/components/responses/ModelNotFoundException"
                    }
                }
            }
        },
        "/game/accuse": {
            "post": {
                "operationId": "game.accuse",
                "summary": "Accuse a persona",
                "tags": [
                    "Game"
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "game_id": {
                                        "type": "string",
                                        "format": "uuid"
                                    },
                                    "accused_persona": {
                                        "type": "string",
                                        "enum": [
                                            "elena",
                                            "tom",
                                            "lisa",
                                            "klaus"
                                        ]
                                    }
                                },
                                "required": [
                                    "game_id",
                                    "accused_persona"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "correct": {
                                            "type": "boolean"
                                        },
                                        "message": {
                                            "type": "string",
                                            "enum": [
                                                "Richtig! Tom Berger ist der M\u00f6rder. Er hat Marcus Weber im Affekt erschlagen, nachdem dieser ihn f\u00e4lschlicherweise des Geheimnisverrats beschuldigt hatte.",
                                                "Falsch! Der wahre M\u00f6rder ist Tom Berger. Er hat Marcus erschlagen, nachdem dieser ihn ungerechtfertigt des Geheimnisverrats beschuldigt hatte."
                                            ]
                                        },
                                        "solution": {
                                            "type": "object",
                                            "properties": {
                                                "murderer": {
                                                    "type": "string",
                                                    "enum": [
                                                        "Tom Berger"
                                                    ]
                                                },
                                                "motive": {
                                                    "type": "string",
                                                    "enum": [
                                                        "Marcus beschuldigte Tom f\u00e4lschlicherweise, Firmengeheimnisse gestohlen zu haben und drohte mit K\u00fcndigung."
                                                    ]
                                                },
                                                "weapon": {
                                                    "type": "string",
                                                    "enum": [
                                                        "Bronzene \"Innovator des Jahres\" Troph\u00e4e"
                                                    ]
                                                }
                                            },
                                            "required": [
                                                "murderer",
                                                "motive",
                                                "weapon"
                                            ]
                                        }
                                    },
                                    "required": [
                                        "correct",
                                        "message",
                                        "solution"
                                    ]
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "enum": [
                                                "Game is not active"
                                            ]
                                        }
                                    },
                                    "required": [
                                        "error"
                                    ]
                                }
                            }
                        }
                    },
                    "422": {
                        "$ref": "#/components/responses/ValidationException"
                    }
                }
            }
        }
    },
    "components": {
        "responses": {
            "ValidationException": {
                "description": "Validation error",
                "content": {
                    "application/json": {
                        "schema": {
                            "type": "object",
                            "properties": {
                                "message": {
                                    "type": "string",
                                    "description": "Errors overview."
                                },
                                "errors": {
                                    "type": "object",
                                    "description": "A detailed description of each field that failed validation.",
                                    "additionalProperties": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        }
                                    }
                                }
                            },
                            "required": [
                                "message",
                                "errors"
                            ]
                        }
                    }
                }
            },
            "ModelNotFoundException": {
                "description": "Not found",
                "content": {
                    "application/json": {
                        "schema": {
                            "type": "object",
                            "properties": {
                                "message": {
                                    "type": "string",
                                    "description": "Error overview."
                                }
                            },
                            "required": [
                                "message"
                            ]
                        }
                    }
                }
            }
        }
    }
}